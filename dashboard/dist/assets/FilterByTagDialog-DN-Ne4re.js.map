{"version":3,"file":"FilterByTagDialog-DN-Ne4re.js","sources":["../../node_modules/@jbrowse/plugin-alignments/esm/shared/components/FilterByTagDialog.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { Dialog } from '@jbrowse/core/ui';\nimport { Button, DialogActions, DialogContent, Link, Paper, TextField, Typography, } from '@mui/material';\nimport { observer } from 'mobx-react';\nimport { makeStyles } from 'tss-react/mui';\nconst useStyles = makeStyles()(theme => ({\n    paper: {\n        padding: theme.spacing(2),\n        margin: theme.spacing(2),\n    },\n    field: {\n        margin: theme.spacing(2),\n    },\n}));\nconst flagNames = [\n    'read paired',\n    'read mapped in proper pair',\n    'read unmapped',\n    'mate unmapped',\n    'read reverse strand',\n    'mate reverse strand',\n    'first in pair',\n    'second in pair',\n    'not primary alignment',\n    'read fails platform/vendor quality checks',\n    'read is PCR or optical duplicate',\n    'supplementary alignment',\n];\nfunction Bitmask(props) {\n    const { flag = 0, setFlag } = props;\n    return (React.createElement(React.Fragment, null,\n        React.createElement(TextField, { type: \"number\", value: flag, onChange: event => {\n                setFlag(+event.target.value);\n            } }),\n        flagNames.map((name, index) => {\n            const val = flag & (1 << index);\n            const key = `${name}_${val}`;\n            return (React.createElement(\"div\", { key: key },\n                React.createElement(\"input\", { type: \"checkbox\", checked: Boolean(val), onChange: event => {\n                        if (event.target.checked) {\n                            setFlag(flag | (1 << index));\n                        }\n                        else {\n                            setFlag(flag & ~(1 << index));\n                        }\n                    } }),\n                React.createElement(\"label\", { htmlFor: key }, name)));\n        })));\n}\nconst FilterByTagDialog = observer(function (props) {\n    var _a, _b;\n    const { model, handleClose } = props;\n    const { classes } = useStyles();\n    const { filterBy } = model;\n    const [flagInclude, setFlagInclude] = useState(filterBy.flagInclude);\n    const [flagExclude, setFlagExclude] = useState(filterBy.flagExclude);\n    const [tag, setTag] = useState(((_a = filterBy.tagFilter) === null || _a === void 0 ? void 0 : _a.tag) || '');\n    const [tagValue, setTagValue] = useState(((_b = filterBy.tagFilter) === null || _b === void 0 ? void 0 : _b.value) || '');\n    const [readName, setReadName] = useState(filterBy.readName || '');\n    const validTag = /^[A-Za-z][A-Za-z0-9]$/.exec(tag);\n    const site = 'https://broadinstitute.github.io/picard/explain-flags.html';\n    return (React.createElement(Dialog, { open: true, onClose: handleClose, title: \"Filter options\" },\n        React.createElement(DialogContent, null,\n            React.createElement(Typography, null,\n                \"Set filter bitmask options. Refer to \",\n                React.createElement(Link, { href: site }, site),\n                ' ',\n                \"for details\"),\n            React.createElement(Paper, { className: classes.paper, variant: \"outlined\" },\n                React.createElement(\"div\", { style: { display: 'flex' } },\n                    React.createElement(\"div\", null,\n                        React.createElement(Typography, null, \"Read must have ALL these flags\"),\n                        React.createElement(Bitmask, { flag: flagInclude, setFlag: setFlagInclude })),\n                    React.createElement(\"div\", null,\n                        React.createElement(Typography, null, \"Read must have NONE of these flags\"),\n                        React.createElement(Bitmask, { flag: flagExclude, setFlag: setFlagExclude })))),\n            React.createElement(Paper, { className: classes.paper, variant: \"outlined\" },\n                React.createElement(Typography, null, \"Filter by tag name and value. Use * in the value field to get all reads containing any value for that tag. Example: filter tag name SA with value * to get all split/supplementary reads. Other examples include HP for haplotype, or RG for read group\"),\n                React.createElement(TextField, { className: classes.field, value: tag, onChange: event => {\n                        setTag(event.target.value);\n                    }, placeholder: \"Enter tag name\", error: tag.length === 2 && !validTag, helperText: tag.length === 2 && !validTag ? 'Not a valid tag' : '', slotProps: {\n                        htmlInput: {\n                            maxLength: 2,\n                        },\n                    } }),\n                React.createElement(TextField, { className: classes.field, value: tagValue, onChange: event => {\n                        setTagValue(event.target.value);\n                    }, placeholder: \"Enter tag value\" })),\n            React.createElement(Paper, { className: classes.paper, variant: \"outlined\" },\n                React.createElement(Typography, null, \"Filter by read name\"),\n                React.createElement(TextField, { className: classes.field, value: readName, onChange: event => {\n                        setReadName(event.target.value);\n                    }, placeholder: \"Enter read name\" })),\n            React.createElement(DialogActions, null,\n                React.createElement(Button, { variant: \"contained\", color: \"primary\", autoFocus: true, type: \"submit\", onClick: () => {\n                        model.setFilterBy({\n                            flagInclude,\n                            flagExclude,\n                            readName,\n                            tagFilter: tag !== ''\n                                ? {\n                                    tag,\n                                    value: tagValue,\n                                }\n                                : undefined,\n                        });\n                        handleClose();\n                    } }, \"Submit\"),\n                React.createElement(Button, { variant: \"contained\", color: \"secondary\", onClick: () => {\n                        handleClose();\n                    } }, \"Cancel\")))));\n});\nexport default FilterByTagDialog;\n"],"names":["useStyles","makeStyles","theme","flagNames","Bitmask","props","flag","setFlag","React","TextField","event","name","index","val","key","FilterByTagDialog","observer","_a","_b","model","handleClose","classes","filterBy","flagInclude","setFlagInclude","useState","flagExclude","setFlagExclude","tag","setTag","tagValue","setTagValue","readName","setReadName","validTag","site","Dialog","DialogContent","Typography","Link","Paper","DialogActions","Button"],"mappings":"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","x_google_ignoreList":[0]}