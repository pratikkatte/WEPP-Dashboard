{"version":3,"file":"FromConfigAdapter-mSHhK6AL.js","sources":["../node_modules/@jbrowse/plugin-config/esm/FromConfigAdapter/FromConfigAdapter.js"],"sourcesContent":["import { readConfObject } from '@jbrowse/core/configuration';\nimport { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter';\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs';\nimport SimpleFeature from '@jbrowse/core/util/simpleFeature';\nexport function makeFeatures(fdata) {\n    const features = new Map();\n    for (const entry of fdata) {\n        const f = new SimpleFeature(entry);\n        const refName = f.get('refName');\n        let bucket = features.get(refName);\n        if (!bucket) {\n            bucket = [];\n            features.set(refName, bucket);\n        }\n        bucket.push(f);\n    }\n    for (const refFeatures of features.values()) {\n        refFeatures.sort((a, b) => a.get('start') - b.get('start'));\n    }\n    return features;\n}\nexport default class FromConfigAdapter extends BaseFeatureDataAdapter {\n    constructor(conf, getSubAdapter, pluginManager) {\n        super(conf, getSubAdapter, pluginManager);\n        const feats = readConfObject(conf, 'features');\n        this.features = makeFeatures(feats);\n    }\n    async getRefNames() {\n        return [...this.features.keys()];\n    }\n    async getRefNameAliases() {\n        return [...this.features.values()].map(featureArray => ({\n            refName: featureArray[0].get('refName'),\n            aliases: featureArray[0].get('aliases'),\n        }));\n    }\n    getFeatures(region) {\n        const { refName, start, end } = region;\n        return ObservableCreate(async (observer) => {\n            const features = this.features.get(refName) || [];\n            for (const f of features) {\n                if (f.get('end') > start && f.get('start') < end) {\n                    observer.next(f);\n                }\n            }\n            observer.complete();\n        });\n    }\n    freeResources() { }\n}\n"],"names":["makeFeatures","fdata","features","entry","f","SimpleFeature","refName","bucket","refFeatures","a","b","FromConfigAdapter","BaseFeatureDataAdapter","conf","getSubAdapter","pluginManager","feats","readConfObject","featureArray","region","start","end","ObservableCreate","observer"],"mappings":"2KAIO,SAASA,EAAaC,EAAO,CAChC,MAAMC,EAAW,IAAI,IACrB,UAAWC,KAASF,EAAO,CACvB,MAAMG,EAAI,IAAIC,EAAcF,CAAK,EAC3BG,EAAUF,EAAE,IAAI,SAAS,EAC/B,IAAIG,EAASL,EAAS,IAAII,CAAO,EAC5BC,IACDA,EAAS,CAAE,EACXL,EAAS,IAAII,EAASC,CAAM,GAEhCA,EAAO,KAAKH,CAAC,CACrB,CACI,UAAWI,KAAeN,EAAS,SAC/BM,EAAY,KAAK,CAACC,EAAGC,IAAMD,EAAE,IAAI,OAAO,EAAIC,EAAE,IAAI,OAAO,CAAC,EAE9D,OAAOR,CACX,CACe,MAAMS,UAA0BC,EAAAA,sBAAuB,CAClE,YAAYC,EAAMC,EAAeC,EAAe,CAC5C,MAAMF,EAAMC,EAAeC,CAAa,EACxC,MAAMC,EAAQC,EAAAA,eAAeJ,EAAM,UAAU,EAC7C,KAAK,SAAWb,EAAagB,CAAK,CAC1C,CACI,MAAM,aAAc,CAChB,MAAO,CAAC,GAAG,KAAK,SAAS,KAAI,CAAE,CACvC,CACI,MAAM,mBAAoB,CACtB,MAAO,CAAC,GAAG,KAAK,SAAS,OAAM,CAAE,EAAE,IAAIE,IAAiB,CACpD,QAASA,EAAa,CAAC,EAAE,IAAI,SAAS,EACtC,QAASA,EAAa,CAAC,EAAE,IAAI,SAAS,CAClD,EAAU,CACV,CACI,YAAYC,EAAQ,CAChB,KAAM,CAAE,QAAAb,EAAS,MAAAc,EAAO,IAAAC,CAAK,EAAGF,EAChC,OAAOG,EAAAA,iBAAiB,MAAOC,GAAa,CACxC,MAAMrB,EAAW,KAAK,SAAS,IAAII,CAAO,GAAK,CAAE,EACjD,UAAWF,KAAKF,EACRE,EAAE,IAAI,KAAK,EAAIgB,GAAShB,EAAE,IAAI,OAAO,EAAIiB,GACzCE,EAAS,KAAKnB,CAAC,EAGvBmB,EAAS,SAAU,CAC/B,CAAS,CACT,CACI,eAAgB,CAAA,CACpB","x_google_ignoreList":[0]}