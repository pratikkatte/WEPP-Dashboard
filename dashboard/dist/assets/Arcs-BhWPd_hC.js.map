{"version":3,"mappings":"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","names":["makeFeaturePair","feature","alt","_a","_b","_c","_d","bnd","parseBreakend","start","end","strand","mate","refName","mateRefName","mateEnd","mateStart","joinDirection","mateDirection","a","info","e","matePosition","makeSummary","k1","k2","assembleLocString","f","ArcTooltip","lazy","Arc","observer","model","assembly","view","mouseOvered","setMouseOvered","useState","height","ref","useRef","c","getConf","ra1","ra2","p1","p2","r1","r2","radius","absrad","destY","left","right","col","sw","React","getStrokeProps","Suspense","Wrapper","exportSVG","children","getContainingView","width","Arcs","session","getSession","assemblyManager","features","alts"],"ignoreList":[0,1],"sources":["../../node_modules/@jbrowse/plugin-arc/esm/LinearPairedArcDisplay/components/util.js","../../node_modules/@jbrowse/plugin-arc/esm/LinearPairedArcDisplay/components/Arcs.js"],"sourcesContent":["import { parseBreakend } from '@gmod/vcf';\nimport { assembleLocString } from '@jbrowse/core/util';\nexport function makeFeaturePair(feature, alt) {\n    var _a, _b, _c, _d;\n    const bnd = alt ? parseBreakend(alt) : undefined;\n    const start = feature.get('start');\n    let end = feature.get('end');\n    const strand = feature.get('strand');\n    const mate = feature.get('mate');\n    const refName = feature.get('refName');\n    let mateRefName;\n    let mateEnd = 0;\n    let mateStart = 0;\n    let joinDirection = 0;\n    let mateDirection = 0;\n    const symbolicAlleles = ['<TRA', '<DEL', '<INV', '<INS', '<DUP', '<CNV'];\n    if (symbolicAlleles.some(a => alt === null || alt === void 0 ? void 0 : alt.startsWith(a))) {\n        const info = feature.get('INFO');\n        const e = (_b = (_a = info === null || info === void 0 ? void 0 : info.END) === null || _a === void 0 ? void 0 : _a[0]) !== null && _b !== void 0 ? _b : end;\n        mateRefName = (_d = (_c = info === null || info === void 0 ? void 0 : info.CHR2) === null || _c === void 0 ? void 0 : _c[0]) !== null && _d !== void 0 ? _d : refName;\n        mateEnd = e;\n        mateStart = e - 1;\n        end = start + 1;\n    }\n    else if (bnd === null || bnd === void 0 ? void 0 : bnd.MatePosition) {\n        const matePosition = bnd.MatePosition.split(':');\n        mateDirection = bnd.MateDirection === 'left' ? 1 : -1;\n        joinDirection = bnd.Join === 'left' ? -1 : 1;\n        mateEnd = +matePosition[1];\n        mateStart = +matePosition[1] - 1;\n        mateRefName = matePosition[0];\n    }\n    return {\n        k1: {\n            refName,\n            start,\n            end,\n            strand,\n            mateDirection,\n        },\n        k2: mate !== null && mate !== void 0 ? mate : {\n            refName: mateRefName || 'unknown',\n            end: mateEnd,\n            start: mateStart,\n            mateDirection: joinDirection,\n        },\n    };\n}\nexport function makeSummary(feature, alt) {\n    var _a;\n    const { k1, k2 } = makeFeaturePair(feature, alt);\n    return [\n        feature.get('name'),\n        feature.get('id'),\n        assembleLocString(k1),\n        assembleLocString(k2),\n        (_a = feature.get('INFO')) === null || _a === void 0 ? void 0 : _a.SVTYPE,\n        alt,\n    ]\n        .filter(f => !!f)\n        .join(' - ');\n}\n","import React, { Suspense, lazy, useRef, useState } from 'react';\nimport { getConf } from '@jbrowse/core/configuration';\nimport { getContainingView, getSession, getStrokeProps, } from '@jbrowse/core/util';\nimport { observer } from 'mobx-react';\nimport { makeFeaturePair, makeSummary } from './util';\nconst ArcTooltip = lazy(() => import('../../ArcTooltip'));\nconst Arc = observer(function ({ model, feature, alt, assembly, view, }) {\n    var _a, _b;\n    const [mouseOvered, setMouseOvered] = useState(false);\n    const { height } = model;\n    const { k1, k2 } = makeFeaturePair(feature, alt);\n    const ref = useRef(null);\n    const c = getConf(model, 'color', { feature, alt });\n    const ra1 = assembly.getCanonicalRefName(k1.refName) || k1.refName;\n    const ra2 = assembly.getCanonicalRefName(k2.refName) || k2.refName;\n    const p1 = k1.start;\n    const p2 = k2.start;\n    const r1 = (_a = view.bpToPx({ refName: ra1, coord: p1 })) === null || _a === void 0 ? void 0 : _a.offsetPx;\n    const r2 = (_b = view.bpToPx({ refName: ra2, coord: p2 })) === null || _b === void 0 ? void 0 : _b.offsetPx;\n    if (r1 !== undefined && r2 !== undefined) {\n        const radius = (r2 - r1) / 2;\n        const absrad = Math.abs(radius);\n        const destY = Math.min(height, absrad);\n        const p1 = r1 - view.offsetPx;\n        const p2 = r2 - view.offsetPx;\n        const left = p1;\n        const right = p2;\n        const col = mouseOvered ? 'black' : c;\n        const sw = 3;\n        return absrad > 1 ? (React.createElement(React.Fragment, null,\n            React.createElement(\"path\", { d: `M ${left} 0 C ${left} ${destY}, ${right} ${destY}, ${right} 0`, ref: ref, ...getStrokeProps(col), strokeWidth: sw, onMouseOut: () => {\n                    setMouseOvered(false);\n                }, onMouseOver: () => {\n                    setMouseOvered(true);\n                }, onClick: () => {\n                    model.selectFeature(feature);\n                }, fill: \"none\", pointerEvents: \"stroke\" }),\n            k1.mateDirection ? (React.createElement(\"line\", { ...getStrokeProps(col), strokeWidth: sw, onMouseOut: () => {\n                    setMouseOvered(false);\n                }, onMouseOver: () => {\n                    setMouseOvered(true);\n                }, onClick: () => {\n                    model.selectFeature(feature);\n                }, x1: left, x2: left + k1.mateDirection * 20, y1: 1.5, y2: 1.5 })) : null,\n            k2.mateDirection ? (React.createElement(\"line\", { ...getStrokeProps(col), strokeWidth: sw, onMouseOut: () => {\n                    setMouseOvered(false);\n                }, onMouseOver: () => {\n                    setMouseOvered(true);\n                }, onClick: () => {\n                    model.selectFeature(feature);\n                }, x1: right, x2: right + k2.mateDirection * 20, y1: 1.5, y2: 1.5 })) : null,\n            mouseOvered ? (React.createElement(Suspense, { fallback: null },\n                React.createElement(ArcTooltip, { contents: makeSummary(feature, alt) }))) : null)) : null;\n    }\n    return null;\n});\nconst Wrapper = observer(function ({ model, exportSVG, children, }) {\n    const { height } = model;\n    const view = getContainingView(model);\n    const width = Math.round(view.dynamicBlocks.totalWidthPx);\n    return exportSVG ? (children) : (React.createElement(\"svg\", { width: width, height: height }, children));\n});\nconst Arcs = observer(function ({ model, exportSVG, }) {\n    const view = getContainingView(model);\n    const session = getSession(model);\n    const { assemblyManager } = session;\n    const { features } = model;\n    const assembly = assemblyManager.get(view.assemblyNames[0]);\n    return assembly ? (React.createElement(Wrapper, { model: model, exportSVG: exportSVG }, features === null || features === void 0 ? void 0 : features.map(f => {\n        var _a;\n        const alts = f.get('ALT');\n        return ((_a = alts === null || alts === void 0 ? void 0 : alts.map(a => (React.createElement(Arc, { key: `${f.id()}-${a}`, session: session, feature: f, alt: a, view: view, model: model, assembly: assembly })))) !== null && _a !== void 0 ? _a : (React.createElement(Arc, { key: f.id(), session: session, feature: f, view: view, model: model, assembly: assembly })));\n    }))) : null;\n});\nexport default Arcs;\n"],"file":"assets/Arcs-BhWPd_hC.js"}