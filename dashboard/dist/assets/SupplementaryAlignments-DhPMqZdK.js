const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BreakendSingleLevelOptionDialog-CyVWpYnN.js","./index-8oJY38fj.js","./index-7Hk6Ie7E.css"])))=>i.map(i=>d[i]);
import{u,bg as b,t as k,bh as $,a as y,R as a,T as h,c as A,L as E,_ as v,bi as R}from"./index-8oJY38fj.js";import{B}from"./BaseCard-BCBOBc5z.js";import{n as C}from"./AlignmentsFeatureDetail-BDj8Gdo3.js";import"./FeatureDetails-BDGSoO8_.js";import"./SimpleField-DnY3K_Rh.js";async function D({view:e,feature:n}){var s;const{assemblyManager:o}=u.getSession(e),r=n.get("CIGAR"),l=n.get("strand"),g=((s=n.get("tags"))===null||s===void 0?void 0:s.SA)||"",p=n.get("name"),t=b(r,1),f=await o.waitForAssembly(e.assemblyNames[0]);if(!f)throw new Error("assembly not found");const c=k(g,n.id(),l,p,!0),i=n.toJSON();i.clipPos=t,i.strand=1,i.mate={refName:p,start:t,end:t+$(r)};const S=[i,...c];return S.forEach((m,d)=>{m.refName=f.getCanonicalRefName(m.refName)||m.refName,m.syntenyId=d,m.mate.syntenyId=d,m.mate.uniqueId=`${m.uniqueId}_mate`}),S.sort((m,d)=>m.clipPos-d.clipPos),S}const P=y.lazy(()=>v(()=>import("./BreakendSingleLevelOptionDialog-CyVWpYnN.js").then(e=>e.B),__vite__mapDeps([0,1,2]),import.meta.url)),V=y.lazy(()=>v(()=>import("./BreakendSingleLevelOptionDialog-CyVWpYnN.js").then(e=>e.a),__vite__mapDeps([0,1,2]),import.meta.url));function I({model:e,feature:n}){const{view:s}=e,[o,r]=y.useState(),[l,g]=y.useState();y.useEffect(()=>{(async()=>{try{const t=await D({view:s,feature:new u.SimpleFeature(n)});r(t)}catch(t){g(t),console.error(t)}})()},[n,s]);const p=[];if(o)for(let t=0;t<o.length-1;t++)p.push([o[t],o[t+1]]);return p.length?a.createElement("div",null,a.createElement(h,null,"Launch split view"),l?a.createElement(A.ErrorMessage,{error:l}):null,a.createElement("ul",null,p.map((t,f)=>{const[c,i]=t;return a.createElement("li",{key:`${JSON.stringify(t)}-${f}`},c.refName,":",u.toLocale(c.strand===1?c.end:c.start)," ->"," ",i.refName,":",u.toLocale(i.strand===1?i.start:i.end)," ",a.createElement(O,{model:e,f1:c,f2:i})," ",a.createElement(T,{model:e,f1:c,f2:i}))}))):null}function O({model:e,f1:n,f2:s}){return a.createElement(E,{href:"#",onClick:o=>{o.preventDefault();const r=u.getSession(e);r.queueDialog(l=>[P,{handleClose:l,session:r,feature:new u.SimpleFeature({...n,mate:s}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])}},"(top/bottom)")}function T({model:e,f1:n,f2:s}){return a.createElement(E,{href:"#",onClick:o=>{o.preventDefault();const r=u.getSession(e);r.queueDialog(l=>[V,{handleClose:l,session:r,feature:new u.SimpleFeature({...n,mate:s}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])}},"(single row)")}function M({tag:e,model:n}){return a.createElement("div",null,a.createElement(h,null,"List of supplementary alignment locations"),a.createElement("ul",null,e.split(";").filter(s=>!!s).map((s,o)=>{const[r,l,g,p]=s.split(","),t=R(p),f=Math.floor(t/5),c=+l,i=+l+t,S=c-f,m=i+f,d=`${r}:${Math.max(1,S)}-${m}`,w=c.toLocaleString("en-US"),L=i.toLocaleString("en-US"),N=`${r}:${w}-${L} (${g}) [${t}bp]`;return a.createElement("li",{key:`${d}-${o}`},a.createElement(E,{href:"#",onClick:async _=>{_.preventDefault(),C(d,n)}},N))})))}function U(e){const{model:n,tag:s,feature:o}=e,r=u.getSession(n),{pluginManager:l}=u.getEnv(r);let g=!1;try{g=!!l.getViewType("BreakpointSplitView")}catch{}return a.createElement(B,{...e,title:"Supplementary alignments"},a.createElement(M,{model:n,tag:s}),g?a.createElement(I,{model:n,feature:o}):null)}export{U as default};
//# sourceMappingURL=SupplementaryAlignments-DhPMqZdK.js.map
